<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>diurnal &mdash; diurnal 1.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="User Guide" href="user_guide.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            diurnal
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="user_guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="source/modules.html">Source Code Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer_guide.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="literature_review.html">Literature Review</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">diurnal</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">diurnal</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="diurnal">
<h1>diurnal<a class="headerlink" href="#diurnal" title="Permalink to this headline"></a></h1>
<p><code class="docutils literal notranslate"><span class="pre">diurnal</span></code> is a Python library that facilitates RNA secondary structure
predictions.</p>
<p>This library aims at streamlining the process of elaborating, training, and
validating RNA structure predictive models. Researchers can use it under the MIT
license to develop and publish models that can be easily replicated by other
users.</p>
<p>This page presents an <a class="reference internal" href="#overview"><span class="std std-ref">Overview</span></a> of the project and its
<a class="reference internal" href="#usage"><span class="std std-ref">Basic Usage</span></a>. The <a class="reference internal" href="user_guide.html#user-guide"><span class="std std-ref">User Guide</span></a> provides detailed explanations of
the library. The <a class="reference internal" href="source/modules.html#source-code-documentation"><span class="std std-ref">Source Code Documentation</span></a> presents the signature
of all the components of the library. The <a class="reference internal" href="literature_review.html#lit-review"><span class="std std-ref">Literature Review</span></a> provides the list of
references that were used to develop the project and discusses other similar
projects. The <a class="reference internal" href="developer_guide.html#developer-guide"><span class="std std-ref">Developer Guide</span></a> explains how the project is organized and
how to contribute to it.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="user_guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="source/modules.html">Source Code Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer_guide.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="literature_review.html">Literature Review</a></li>
</ul>
</div>
<section id="overview">
<span id="id1"></span><h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"></a></h2>
<p>This library contains <strong>RNA secondary structure predictive models</strong>. It also
comprises utility components that automate data processing tasks.</p>
<p>In short, RNA secondary structure describes the <em>pairings</em> of nucleotides. RNA
(ribonucleic acid) is a molecule that performs a variety of biological
functions. It is therefore the subject of interest for molecular biologists who
aim at determining their function. An RNA molecules is made of a chain of
<em>nucleotides</em> that can fold onto itself. One can describe the structure of RNA
molecules in different ways.</p>
<ul class="simple">
<li><p>The sequence of nucleotides is the <em>primary structure</em>. In general, RNA uses
four possible nucleotides: adenine, cytosine, guanine, and uracil. They are
represented by the letters <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">C</span></code>, <code class="docutils literal notranslate"><span class="pre">G</span></code>, and <code class="docutils literal notranslate"><span class="pre">U</span></code>, respectively.</p></li>
<li><p>The way that nucleotides combine with one another is the <em>secondary
structure</em>. One way to represent the secondary structure is to use the
<strong>dot-bracket notation</strong>. Unpaired nucleotides are represented by a dot
(<code class="docutils literal notranslate"><span class="pre">.</span></code>). A nucleotide paired with a nucleotide closer to the 3’ end of the
molecule (i.e. to the right) is represented by an opening parenthesis
( <code class="docutils literal notranslate"><span class="pre">(</span></code> ). A nucleotide paired with a nucleotide closer to the 5’ end of the
molecule (i.e. to the left) is represented by a closing parenthesis ( <code class="docutils literal notranslate"><span class="pre">)</span></code> ).</p></li>
<li><p>The 3D arrangement of the molecule is the <em>tertiary structure</em>. The tertiary
structure is not studied in this project but can be used to better understand
the function of the molecule.</p></li>
</ul>
<p>The image below displays the primary and secondary structures of a short RNA
molecule.</p>
<figure class="align-default" id="id4">
<img alt="Primary and secondary structures of a simple RNA molecule. The left part of the image displays a straight chain of 31 nucleotides. This is the primary structure. The right part of the image shows a 2D representation of paired nucleotides that form stems and loops. This is the secondary structure." src="_images/structure_example.png" />
<figcaption>
<p><span class="caption-text">Primary and secondary structures of a short RNA molecule. Nucleotide sequence
taken from <span id="id2">[<a class="reference internal" href="user_guide.html#id17" title="Mehdi Saman Booy, Alexander Ilin, and Pekka Orponen. Rna secondary structure prediction with convolutional neural networks. BMC Bioinformatics, 23(1):58, 2022. URL: https://doi.org/10.1186/s12859-021-04540-7, doi:10.1186/s12859-021-04540-7.">1</a>]</span> and images generated with the <code class="docutils literal notranslate"><span class="pre">forna</span></code>
<span id="id3">[<a class="reference internal" href="user_guide.html#id27" title="Accessed: 2023-07-15. URL: http://rna.tbi.univie.ac.at/forna/.">2</a>]</span> visualization tool.</span><a class="headerlink" href="#id4" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>In the example above:</p>
<ul class="simple">
<li><p>The <strong>primary structure</strong> can be represented as
<code class="docutils literal notranslate"><span class="pre">CGUGUCAGGUCCGGAAGGAAGCAGCACUAAC</span></code>.</p></li>
<li><p>The <strong>secondary structure</strong> can be represented as
<code class="docutils literal notranslate"><span class="pre">.((((....(((....)))....))))....</span></code>.</p></li>
</ul>
<p>Since determining the function of an RNA molecule from its primary structure is
difficult, researchers rely on its secondary structure. Unfortunately,
determining secondary structures experimentally is costly and time-consuming.
There is hence an interest in reliably determining secondary structures from
primary structures to understand the function of RNA molecules more effectively.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">diurnal</span></code> library <strong>predicts secondary structures from primary
structures</strong>. It can:</p>
<ul class="simple">
<li><p>download RNA structure datasets,</p></li>
<li><p>encode the datasets into trainable representations,</p></li>
<li><p>prepare the data for different evaluation methods,</p></li>
<li><p>train and evaluate models, and</p></li>
<li><p>visualize results.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">diurnal</span></code> is released under the MIT license and developed in Python. It relies
on the <code class="docutils literal notranslate"><span class="pre">Numpy</span></code> and <code class="docutils literal notranslate"><span class="pre">PyTorch</span></code> libraries for data manipulation and neural
network utilization.</p>
</section>
<section id="basic-usage">
<span id="usage"></span><h2>Basic Usage<a class="headerlink" href="#basic-usage" title="Permalink to this headline"></a></h2>
<p><strong>Install</strong> the library with the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>diurnal
</pre></div>
</div>
<p>The code snippet below illustrates how to use the library to fetch data, train
a CNN-based model, and evaluate the model. More advanced usage is explained in
the <a class="reference internal" href="user_guide.html#user-guide"><span class="std std-ref">User Guide</span></a>. You can test this example by copying it in a file and
executing it as a Python script.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">diurnal</span> <span class="kn">import</span> <span class="n">database</span><span class="p">,</span> <span class="n">family</span><span class="p">,</span> <span class="n">train</span>
<span class="kn">import</span> <span class="nn">diurnal.models</span>
<span class="kn">from</span> <span class="nn">diurnal.models.networks</span> <span class="kn">import</span> <span class="n">cnn</span>

<span class="n">SIZE</span> <span class="o">=</span> <span class="mi">512</span>  <span class="c1"># Maximum length of molecules used for training.</span>

<span class="c1"># Download the `archiveII` dataset in the `data/` directory.</span>
<span class="n">database</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;./data/&quot;</span><span class="p">,</span> <span class="s2">&quot;archiveII&quot;</span><span class="p">)</span>
<span class="c1"># Format the raw data from the `archiveII` dataset into Numpy vectors.</span>
<span class="n">database</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="s2">&quot;./data/archiveII&quot;</span><span class="p">,</span>  <span class="c1"># Directory of the raw data to format.</span>
    <span class="s2">&quot;./data/formatted&quot;</span><span class="p">,</span>  <span class="c1"># Formatted data output directory.</span>
    <span class="n">SIZE</span>  <span class="c1"># Normalized size.</span>
<span class="p">)</span>

<span class="c1"># Use the `5s` family as the test set and others as the training set.</span>
<span class="n">test_family</span> <span class="o">=</span> <span class="s2">&quot;5s&quot;</span>
<span class="n">train_families</span> <span class="o">=</span> <span class="n">family</span><span class="o">.</span><span class="n">all_but</span><span class="p">(</span><span class="n">test_family</span><span class="p">)</span>
<span class="n">test_set</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">load_families</span><span class="p">(</span><span class="s2">&quot;./data/formatted&quot;</span><span class="p">,</span> <span class="n">test_family</span><span class="p">)</span>
<span class="n">train_set</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">load_families</span><span class="p">(</span><span class="s2">&quot;./data/formatted&quot;</span><span class="p">,</span> <span class="n">train_families</span><span class="p">)</span>

<span class="c1"># Create a predictive model.</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">diurnal</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">NN</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">cnn</span><span class="o">.</span><span class="n">Dot_Bracket</span><span class="p">,</span>
    <span class="n">N</span><span class="o">=</span><span class="n">SIZE</span><span class="p">,</span>
    <span class="n">n_epochs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">,</span>
    <span class="n">loss_fn</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">,</span>
    <span class="n">optimizer_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;eps&quot;</span><span class="p">:</span> <span class="mf">1e-4</span><span class="p">},</span>
    <span class="n">loss_fn_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">verbosity</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">train_set</span><span class="p">)</span>  <span class="c1"># Train the model.</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">test_set</span><span class="p">)</span>  <span class="c1"># Test the model.</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average F1-score: </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="si">:</span><span class="s2">.4</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline"></a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="user_guide.html" class="btn btn-neutral float-right" title="User Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Vincent Therrien.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>